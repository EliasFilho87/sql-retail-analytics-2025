SELECT 
  p.name AS produto,
  p.category AS categoria,
  SUM(oi.quantity) AS quantidade_total,
  ROUND(SUM(oi.quantity * oi.selling_price), 2) AS receita
FROM order_items oi
JOIN products p   ON p.product_id = oi.product_id
JOIN orders   o   ON o.order_id   = oi.order_id
WHERE o.status = 'Conclu√≠do'
GROUP BY p.product_id
ORDER BY receita DESC
LIMIT 10;
